{% extends 'base.html' %}

{% block title %}
    {% if object %}Редактирование получателя{% else %}Добавление получателя{% endif %}
{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row mb-4">
        <div class="col-md-8">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{% url 'mailing:home' %}">Главная</a></li>
                    <li class="breadcrumb-item"><a href="{% url 'users:recipient_list' %}">Получатели</a></li>
                    <li class="breadcrumb-item active">
                        {% if object %}Редактирование{% else %}Добавление{% endif %}
                    </li>
                </ol>
            </nav>
            <h1>
                {% if object %}
                    Редактирование получателя
                {% else %}
                    Добавление получателя
                {% endif %}
            </h1>
        </div>
        <div class="col-md-4 text-end">
            <a href="{% url 'users:recipient_list' %}" class="btn btn-secondary">
                ← Назад к списку
            </a>
        </div>
    </div>

    <div class="card">
        <div class="card-header bg-primary text-white">
            <h5 class="card-title mb-0">
                {% if object %}Редактирование получателя{% else %}Новый получатель{% endif %}
            </h5>
        </div>
        <div class="card-body">
            <form method="post">
                {% csrf_token %}

                {% if form.non_field_errors %}
                    <div class="alert alert-danger">
                        {% for error in form.non_field_errors %}
                            {{ error }}
                        {% endfor %}
                    </div>
                {% endif %}

                <!-- Email (обязательное поле) -->
                <div class="mb-3">
                    <label for="{{ form.email.id_for_label }}" class="form-label">
                        <strong>Email адрес *</strong>
                    </label>
                    <input type="email"
                           name="{{ form.email.name }}"
                           id="{{ form.email.id_for_label }}"
                           class="form-control {% if form.email.errors %}is-invalid{% endif %}"
                           value="{{ form.email.value|default:'' }}"
                           placeholder="email@example.com"
                           required>
                    {% if form.email.errors %}
                        <div class="invalid-feedback">
                            {% for error in form.email.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    {% endif %}
                    <div class="form-text">Обязательное поле. Должно быть уникальным.</div>
                </div>

                <!-- ФИО (необязательное) -->
                <div class="mb-3">
                    <label for="{{ form.fullname.id_for_label }}" class="form-label">
                        <strong>ФИО</strong>
                    </label>
                    <input type="text"
                           name="{{ form.fullname.name }}"
                           id="{{ form.fullname.id_for_label }}"
                           class="form-control {% if form.fullname.errors %}is-invalid{% endif %}"
                           value="{{ form.fullname.value|default:'' }}"
                           placeholder="Введите ФИО получателя"
                           maxlength="50">
                    {% if form.fullname.errors %}
                        <div class="invalid-feedback">
                            {% for error in form.fullname.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    {% endif %}
                    <div class="form-text">Необязательное поле. Максимум 50 символов.</div>
                </div>
                <div class="mb-3">
                    <label for="{{ form.comment.id_for_label }}" class="form-label">
                        <strong>Комментарий</strong>
                    </label>
                    <textarea name="{{ form.comment.name }}"
                              id="{{ form.comment.id_for_label }}"
                              class="form-control {% if form.comment.errors %}is-invalid{% endif %}"
                              rows="3"
                              placeholder="Дополнительная информация о получателе"
                              maxlength="100">{{ form.comment.value|default:'' }}</textarea>
                    {% if form.comment.errors %}
                        <div class="invalid-feedback">
                            {% for error in form.comment.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    {% endif %}
                    <div class="form-text">Необязательное поле. Максимум 100 символов.</div>
                </div>

                <!-- Кнопки -->
                <div class="d-flex gap-2 mt-4">
                    <button type="submit" class="btn btn-success">
                        {% if object %}Обновить получателя{% else %}Добавить получателя{% endif %}
                    </button>
                    <a href="{% url 'users:recipient_list' %}" class="btn btn-secondary">Отмена</a>

                    {% if object %}
                        <a href="{% url 'users:recipient_detail' object.id %}" class="btn btn-outline-primary">
                            Просмотр
                        </a>
                    {% endif %}
                </div>
            </form>
        </div>
    </div>
</div>

<style>
.form-label {
    font-weight: 500;
}
.card {
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
}
</style>
{% endblock %}